<?xml version="1.0" encoding="ISO-8859-1"?>
<ui:composition template="/layout/layout.xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui">
	
	<f:metadata>
		<f:viewAction action="#{usuarioMB.onPageLoad_AltaUsuario()}" />
	</f:metadata>
	
	<ui:define name="title">
		<c:set var="title" value="Alta de usuario" scope="request" />
	</ui:define>
	
	<ui:define name="content">
	
		<h:form id="frm" styleClass="estiloFrm">			
			<h3 style="text-align:center;">Complete los datos del usuario:</h3>
			<p:panelGrid columns="1" style="margin: 0 auto;" rendered="true" >
				<p:messages id="msgPpal" for="msgPpal" showDetail="true" globalOnly="true" closable="true" />			
			
				<p:outputLabel value="Nombre" />
				<p:inputText id="nombre" value="#{usuarioMB.usuarioDTO.nombre}" required="true" requiredMessage="Requerido"
							 validatorMessage="Ingrese un nombre entre 2 y 30 caracteres"/>
				<p:message for="nombre" style="color:red"/>			
	
				<p:outputLabel value="Apellido" />
				<p:inputText id="apellido" value="#{usuarioMB.usuarioDTO.apellido}" required="true" requiredMessage="Requerido"
							 validatorMessage="Ingrese un apellido 2 y 30 caracteres"/>
				<p:message for="apellido" style="color:red"/>
				
				<p:outputLabel value="E-mail" /> 
				<p:inputText id="email" value="#{usuarioMB.usuarioDTO.email}" 
							 validatorMessage="Puede omitir el e-mail o ingresar un e-mail válido de hasta 60 caracteres."/>
			 	<p:message for="email" style="color:red"/>
										
				<p:outputLabel value="Rol"/>
				<p:selectOneMenu id="rol" value="#{usuarioMB.usuarioDTO.idRol}">
	   				<!-- <f:selectItem itemValue="" itemLabel="" /> -->
	   				<f:selectItem itemValue="3" itemLabel="Común" />
	   				<f:selectItem itemValue="2" itemLabel="Experto" />
	   				<f:selectItem itemValue="1" itemLabel="Administrador" />
	   				<p:ajax event="change" render="cedula" update="panelAE"/>	
				</p:selectOneMenu>
				<p:message for="rol" style="color:red" />
				
				<h:panelGrid id="panelAE">
					<!-- CEDULA aparece para Administrador y Experto -->					
					<p:outputLabel value="Cédula" rendered="#{usuarioMB.usuarioDTO.idRol ne 3}" />
					<p:inputText id="cedula" value="#{usuarioMB.usuarioDTO.ci}" required="true" requiredMessage="Requerido"
								 validatorMessage="Cédula inválida" rendered="#{usuarioMB.usuarioDTO.idRol ne 3}"/>
					<p:message for="cedula" style="color:red" rendered="#{usuarioMB.usuarioDTO.idRol ne 3}"/>
					
					<!-- PROFESION solo para Experto -->
					<p:outputLabel value="Profesión" rendered="#{usuarioMB.usuarioDTO.idRol eq 2}" />
					<p:selectOneMenu id="prof" 
									value="#{usuarioMB.usuarioDTO.nombreProfesion}"									 
									rendered="#{usuarioMB.usuarioDTO.idRol eq 2}">
						<f:selectItems value="#{usuarioMB.obtenerProfesiones()}"/> 
					</p:selectOneMenu>
				</h:panelGrid>	
				
				<p:outputLabel value="Nombre de Usuario" />
				<p:inputText id="nomUsuario" value="#{usuarioMB.usuarioDTO.nombreUsuario}" required="true" requiredMessage="Requerido"
							 validatorMessage="Ingrese un nombre de usuario entre 8 y 30 caracteres"/>
				<p:message for="nomUsuario" style="color:red"/>
				
				<p:outputLabel value="Contraseña" />
				<p:password id="contrasena" value="#{usuarioMB.usuarioDTO.contrasena}" required="true" requiredMessage="Requerido"
							   validatorMessage="Ingrese una contraseña entre 8 y 30 caracteres" />
				<p:message for="contrasena" style="color:red"/>
				
				<p:commandButton 	value="Crear usuario" 
									action="#{usuarioMB.crearUsuario()}" 
									update="frm"/>
			</p:panelGrid>
		</h:form>
	</ui:define>
	
	<h:head></h:head>
 
	<body> 
		
	</body>
	
</ui:composition>
